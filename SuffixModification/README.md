# 批量修改文件名脚本

## 功能描述

本脚本用于批量修改文件名，具体功能如下：
- 遍历指定目录下的所有文件
- 识别出文件名后缀为".adoc.docx"的文件
- 将其文件名修改为仅保留".docx"后缀的格式
- 提供操作过程的日志输出
- 支持预览模式，显示将要执行的修改操作

## 环境要求

- Python 3.6+

## 使用方法

### 基本语法

```bash
python rename_files.py <目录路径> [--preview]
```

### 参数说明

- `<目录路径>`: 必需参数，指定要遍历的目录路径
- `--preview`: 可选参数，启用预览模式，只显示将要执行的修改操作，不执行实际修改

### 使用示例

#### 1. 预览模式

```bash
python rename_files.py test_dir --preview
```

此命令会遍历`test_dir`目录，显示所有将要修改的文件，但不会执行实际的重命名操作。

#### 2. 执行模式

```bash
python rename_files.py test_dir
```

此命令会遍历`test_dir`目录，执行实际的重命名操作，将后缀为".adoc.docx"的文件修改为仅保留".docx"后缀的格式。

## 日志输出

脚本会在执行过程中生成详细的日志输出，包括：
- 开始和结束时间
- 找到的需要修改的文件数量
- 每个文件的修改情况（成功或失败）
- 最终的修改结果统计

同时，脚本会将日志信息写入到`rename_files.log`文件中，以便后续查看。

## 注意事项

1. 脚本只会修改后缀为".adoc.docx"的文件，不会影响其他类型的文件
2. 在执行实际修改操作前，建议先使用预览模式查看将要执行的修改操作
3. 如果修改过程中出现错误，脚本会记录错误信息并继续执行其他文件的修改
4. 脚本会递归遍历指定目录下的所有子目录

## 示例输出

### 预览模式输出示例

```
2026-01-30 17:45:18,774 - INFO - 开始处理目录: test_dir
2026-01-30 17:45:18,775 - INFO - 开始时间: 2026-01-30 17:45:18
2026-01-30 17:45:18,775 - INFO - === 预览模式 ===
2026-01-30 17:45:18,775 - INFO - 找到 1 个需要修改的文件:
2026-01-30 17:45:18,775 - INFO - 将修改: test_dir\test1.adoc.docx -> test_dir\test1.docx
2026-01-30 17:45:18,775 - INFO - === 预览完成 ===
2026-01-30 17:45:18,776 - INFO - 结束时间: 2026-01-30 17:45:18
```

### 执行模式输出示例

```
2026-01-30 17:45:30,077 - INFO - 开始处理目录: test_dir
2026-01-30 17:45:30,077 - INFO - 开始时间: 2026-01-30 17:45:30
2026-01-30 17:45:30,077 - INFO - === 执行模式 ===
2026-01-30 17:45:30,078 - INFO - 成功修改: test_dir\test1.adoc.docx -> test_dir\test1.docx
2026-01-30 17:45:30,079 - INFO - === 执行完成 ===
2026-01-30 17:45:30,079 - INFO - 成功修改: 1 个文件
2026-01-30 17:45:30,079 - INFO - 修改失败: 0 个文件
2026-01-30 17:45:30,079 - INFO - 结束时间: 2026-01-30 17:45:30
```
